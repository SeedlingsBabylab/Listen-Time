---
title: "month_by_month"
author: "Sarp Uner"
date: "10/22/2019"
output: html_document
---

```{r setup, include=FALSE, fig.width=6, fig.asp=0.618}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Listened Time

The final listened time output generated by the python script.  

```{r read, results='hide'}
listened_time <- read_csv("output/Total_Listen_Time_Summary.csv")
listened_time_with_months <- listened_time %>% 
    mutate(month = str_match(Filename, "_(\\d{2})_")[,2]) %>% 
  #eb: there are much easier ways to d o this in r:)
  # cf strings cheatsheet here https://rstudio.com/resources/cheatsheets/
    select(Filename, month, everything())
```

Averages per month
```{r avg}
avgs <- listened_time_with_months %>% 
  group_by(month) %>% 
  summarise(avg_listen_time = mean(`Total Listen Time/hour`))

knitr::kable(
  avgs,
  caption = "Mean listened time per month in hours"
)
```

Max and min per month
```{r maxmin}
maxmin <- listened_time_with_months %>% #eb: outlier has a technical definition in stats that this doesn't meet
  group_by(month) %>% 
  summarise(max = max(`Total Listen Time/hour`), min = min(`Total Listen Time/hour`))
knitr::kable(
  maxmin,
  caption = "The maximum and minimum listened time per month in hours"
)
```

Below is a short section of the format of the csv file. Note that for months 6 and 7, total listen time is calculated by subtracting skip and silence times from the last available time stamp in a file. 
```{r mutated, echo=FALSE}
knitr::kable(
  listened_time_with_months[1:5,],
  caption = "A tibble of listened time csv file"
)
```

## Listen Time Histograms 
Below are the histograms for each month. 
```{r histograms, out.width="%25"}
ggplot(data = listened_time_with_months) + geom_histogram(mapping = aes(x = `Total Listen Time/hour`),binwidth=.25) + facet_wrap(~ month, scales = "free")
```

## Problem File List
n.b.: these are only the problematic files IF `Total Listen Time/hour` is being calculated properly, which i'm not sure it is...please look into it.

### month 6 and 7
these dont' have a 'hard and fast' limit on the length, but i'd double check the ones below to make sure
```{r sixseven}
listened_time_with_months %>% 
  filter(month %in% c("06","07") & (`Total Listen Time/hour`>12 | `Total Listen Time/hour`<8))
  
```

### month 8-13
target length: 4 hours
```{r eight_to_thirteen}
listened_time_with_months %>% 
  filter(month %in% c("08","09","10","11","12","13") & (`Total Listen Time/hour`>4.25 | `Total Listen Time/hour`<3.75))
  
```

### month 14-17
target length: 3 hours
```{r fourteen_to_seventeen}
listened_time_with_months %>% 
  filter(month %in% c("14","15","16","17") & (`Total Listen Time/hour`>3.25 | `Total Listen Time/hour`<2.75))
  
```