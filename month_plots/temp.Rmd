---
title: "month_by_month"
author: "Sarp Uner"
date: "10/22/2019"
output: html_document
---

```{r setup, include=FALSE, fig.width=6, fig.asp=0.618}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Listened Time

The final listened time output generated by the python script.  

```{r read, results='hide'}
listened_time <- read_csv("../output/Total_Listen_Time_Summary.csv")
listened_time_with_months <- listened_time %>% 
    mutate(month = str_match(Filename, "_(\\d{2})_")[,2]) %>% 
    select(Filename, month, everything())
```

Averages per month
```{r avg}
avgs <- listened_time_with_months %>% 
  group_by(month) %>% 
  summarise(avg_listen_time = mean(`Total Listen Time/hour`))

knitr::kable(
  avgs,
  caption = "Mean listened time per month in hours"
)
```

Max and min per month
```{r maxmin}
outliers <- listened_time_with_months %>% 
  group_by(month) %>% 
  summarise(max = max(`Total Listen Time/hour`), min = min(`Total Listen Time/hour`))
knitr::kable(
  outliers,
  caption = "The maximum and minimum listened time per month in hours"
)
```

Below is a short section of the format of the csv file. Note that for months 6 and 7, total listen time is calculated by subtracting skip and silence times from the last available time stamp in a file. 
```{r mutated, echo=FALSE}
knitr::kable(
  listened_time_with_months[1:5,],
  caption = "A tibble of listened time csv file"
)
```

## Listen Time Histograms 
Below are the histograms for each month. 
```{r histograms, out.width="%25"}
ggplot(data = listened_time_with_months) + geom_histogram(mapping = aes(x = `Total Listen Time/hour`)) + facet_wrap(~ month)
```
      
