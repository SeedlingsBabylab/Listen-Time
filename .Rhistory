knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
listened_time <- read_csv("/listened_time_more_columns.csv")
listened_time <- read_csv("listened_time_more_columns.csv")
averages <- listened_time %>%
group_by(month) %>%
summarise(mean(total_listen_hr), sd(total_listen_hr), min(total_listen_hr), max(total_listen_hr), n())
listened_time %>%
group_by(month) %>%
ggplot(aes(total_listen_hr)) +
geom_histogram(binwidth = 1) +
xlim(range(listened_time$total_listen_hr)) +
facet_wrap( ~ month, scales = "free_x")
library(kable)
library(knitr)
kable(averages)
listened_time %>%
ggplot(aes(total_listen_hr)) +
geom_histogram(binwidth = 1) +
xlim(range(listened_time$total_listen_hr)) +
facet_wrap( ~ month, scales = "free_x")
listened_time %>%
ggplot(aes(total_listen_hr)) +
geom_histogram(binwidth = 1) +
scale_x_continuous(limits = c(0,16)) +
facet_wrap( ~ month, scales = "free_x")
listened_time %>%
ggplot(aes(total_listen_hr)) +
geom_histogram(binwidth = 1) +
scale_x_continuous(limits = c(-1,18)) +
facet_wrap( ~ month, scales = "free_x")
listened_time %>%
ggplot(aes(total_listen_hr)) +
geom_histogram(binwidth = 1) +
scale_x_continuous(limits = c(-1,20)) +
facet_wrap( ~ month, scales = "free_x")
listened_time %>%
ggplot(aes(total_listen_hr)) +
geom_histogram(binwidth = 1) +
scale_x_continuous(limits = c(-5,20)) +
facet_wrap( ~ month, scales = "free_x")
listened_time %>%
ggplot(aes(total_listen_hr)) +
geom_histogram(binwidth = 1) +
coord_cartesian(xlim = c(0,16)) +
facet_wrap( ~ month, scales = "free_x")
kable(pprint %>% select("M(SD)", "t(DF) for comparison to chance", "t-test p-value", "#positive/#total", "p-value of binomial test"))
pprint <- comp_to_chance %>%
left_join(mean_var_age_tt, by=c("agehalf_day", "TrialType")) %>%
left_join(indiv_to_chance, by=c("agehalf_day", "TrialType")) %>%
mutate(val.print = paste(round(m,3), "(", round(std,3), ")", sep='')) %>%
mutate(c.print = paste(as.character(t), "/", tot, sep='')) %>%
mutate(bin.test = round(binom.test(t,tot)$p.value,3)) %>%
mutate("M(SD)"=val.print,
"t(DF) for comparison to chance"=t.test.text,
"t-test p-value"=t.test.pval.print,
"#positive/#total"=c.print,
"p-value of binomial test"=bin.test)
comp_to_chance <- comp_to_chance %>%
mutate(t.test.text = paste("t(", t.test.df, ")=", round(t.test.tstat,3), sep='')) %>%
mutate(t.test.pval.print = round(t.test.pval,3))
source("data_analysis/ym_analysis.R")
source("ym_graphs.R")
library("knitr")
library("gridExtra")
library("tidyverse")
knitr::opts_chunk$set(fig.width=12, fig.height=12, comment=F, message=F, hide = T, warning = F, echo = F)
older_specific <- comp_to_chance %>% filter(TrialType=="Unique", agehalf_day=="older")
young_specific <- comp_to_chance %>% filter(TrialType=="Unique", agehalf_day=="younger")
young_specific_posmeans <- pos_means %>% filter(TrialType=="Unique", agehalf_day=="younger", over==1)
older_specific_posmeans <- pos_means %>% filter(TrialType=="Unique", agehalf_day=="older", over==1)
young_generic_posmeans <- pos_means %>% filter(TrialType=="Generic", agehalf_day=="younger", over==1)
older_generic_posmeans <- pos_means %>% filter(TrialType=="Generic", agehalf_day=="older", over==1)
young_generic <- comp_to_chance %>% filter(TrialType=="Generic", agehalf_day=="younger")
old_generic <- comp_to_chance %>% filter(TrialType=="Generic", agehalf_day=="older")
n_older <- age_half_num %>% filter(agehalf_day=="older")
n_younger <- age_half_num %>% filter(agehalf_day=="younger")
old_advantage_percent <- round(t_test_comp_age$estimate[1]-t_test_comp_age$estimate[2], 3)*100
comp_to_chance <- comp_to_chance %>%
mutate(t.test.text = paste("t(", t.test.df, ")=", round(t.test.tstat,3), sep='')) %>%
mutate(t.test.pval.print = round(t.test.pval,3))
pprint <- comp_to_chance %>%
left_join(mean_var_age_tt, by=c("agehalf_day", "TrialType")) %>%
left_join(indiv_to_chance, by=c("agehalf_day", "TrialType")) %>%
mutate(val.print = paste(round(m,3), "(", round(std,3), ")", sep='')) %>%
mutate(c.print = paste(as.character(t), "/", tot, sep='')) %>%
mutate(bin.test = round(binom.test(t,tot)$p.value,3)) %>%
mutate("M(SD)"=val.print,
"t(DF) for comparison to chance"=t.test.text,
"t-test p-value"=t.test.pval.print,
"#positive/#total"=c.print,
"p-value of binomial test"=bin.test)
kable(pprint %>% select("M(SD)", "t(DF) for comparison to chance", "t-test p-value", "#positive/#total", "p-value of binomial test"))
timecourse
violins
pprint <- comp_to_chance %>%
left_join(mean_var_age_tt, by=c("agehalf_day", "TrialType")) %>%
left_join(indiv_to_chance, by=c("agehalf_day", "TrialType")) %>%
mutate(val.print = paste(round(m,3), "(", round(std,3), ")", sep='')) %>%
mutate(c.print = paste(as.character(t), "/", tot, sep='')) %>%
mutate(bin.test = round(binom.test(t,tot)$p.value,3)) %>%
mutate("M(SD)"=val.print,
"comp. to chance"=t.test.text,
"t-test p-val"=t.test.pval.print,
"# subjs > chance"=c.print,
"binomial test p-val"=bin.test,
"Age Group"=agehalf_day,
"Trial Type"=TrialType)
kable(pprint %>% select("Age Group", "Trial Type", "M(SD)", "comp. to chance", "t-test p-val", "# subjs > chance", "binomial test p-val"))
kable(pprint %>% select("Age Group", "Trial Type", "M(SD)", "comp. to chance", "t-test p-val", "# subjs > chance", "binomial test p-val") %>% kable_styling(latex_options = c("striped", "scale_down")))
library("kableExtra")
kable(pprint %>% select("Age Group", "Trial Type", "M(SD)", "comp. to chance", "t-test p-val", "# subjs > chance", "binomial test p-val") %>% kable_styling(latex_options = c("striped", "scale_down")))
kable(pprint %>% select("Age Group", "Trial Type", "M(SD)", "comp. to chance", "t-test p-val", "# subjs > chance", "binomial test p-val")) %>% kable_styling(latex_options = c("striped", "scale_down"))
pprint <- comp_to_chance %>%
left_join(mean_var_age_tt, by=c("agehalf_day", "TrialType")) %>%
left_join(indiv_to_chance, by=c("agehalf_day", "TrialType")) %>%
mutate(val.print = paste(round(m,3), "(", round(std,3), ")", sep='')) %>%
mutate(c.print = paste(as.character(t), "/", tot, sep='')) %>%
mutate(bin.test = round(binom.test(t,tot)$p.value,3)) %>%
mutate(TrialType = ifelse(TrialType=="Unique", "Specific", TrialType)) %>%
mutate("M(SD)"=val.print,
"comp. to chance"=t.test.text,
"t-test p-val"=t.test.pval.print,
"# subjs > chance"=c.print,
"binomial test p-val"=bin.test,
"Age Group"=agehalf_day,
"Trial Type"=TrialType) %>%
ungroup()
pprint <- comp_to_chance %>%
left_join(mean_var_age_tt, by=c("agehalf_day", "TrialType")) %>%
left_join(indiv_to_chance, by=c("agehalf_day", "TrialType")) %>%
ungroup() %>%
mutate(val.print = paste(round(m,3), "(", round(std,3), ")", sep='')) %>%
mutate(c.print = paste(as.character(t), "/", tot, sep='')) %>%
mutate(bin.test = round(binom.test(t,tot)$p.value,3)) %>%
mutate(TrialType = ifelse(TrialType=="Unique", "Specific", TrialType)) %>%
mutate("M(SD)"=val.print,
"comp. to chance"=t.test.text,
"t-test p-val"=t.test.pval.print,
"# subjs > chance"=c.print,
"binomial test p-val"=bin.test,
"Age Group"=agehalf_day,
"Trial Type"=TrialType) %>%
ungroup()
pprint <- comp_to_chance %>%
left_join(mean_var_age_tt, by=c("agehalf_day", "TrialType")) %>%
left_join(indiv_to_chance, by=c("agehalf_day", "TrialType")) %>%
ungroup() %>%
mutate(val.print = paste(round(m,3), "(", round(std,3), ")", sep='')) %>%
mutate(c.print = paste(as.character(t), "/", tot, sep='')) %>%
mutate(bin.test = round(binom.test(t,tot)$p.value,3)) %>%
mutate(TrialType = ifelse(TrialType=="Unique", "Specific", TrialType)) %>%
mutate("M(SD)"=val.print,
"comp. to chance"=t.test.text,
"t-test p-val"=t.test.pval.print,
"# subjs > chance"=c.print,
"binomial test p-val"=bin.test,
"Age Group"=agehalf_day,
"Trial Type"=TrialType)
pprint <- comp_to_chance %>%
left_join(mean_var_age_tt, by=c("agehalf_day", "TrialType")) %>%
left_join(indiv_to_chance, by=c("agehalf_day", "TrialType")) %>%
mutate(val.print = paste(round(m,3), "(", round(std,3), ")", sep='')) %>%
mutate(c.print = paste(as.character(t), "/", tot, sep='')) %>%
mutate(bin.test = round(binom.test(t,tot)$p.value,3)) %>%
ungroup() %>%
mutate(TrialType = ifelse(TrialType=="Unique", "Specific", TrialType)) %>%
mutate("M(SD)"=val.print,
"comp. to chance"=t.test.text,
"t-test p-val"=t.test.pval.print,
"# subjs > chance"=c.print,
"binomial test p-val"=bin.test,
"Age Group"=agehalf_day,
"Trial Type"=TrialType)
kable(pprint %>% select("Age Group", "Trial Type", "M(SD)", "comp. to chance", "t-test p-val", "# subjs > chance", "binomial test p-val")) %>% kable_styling(latex_options = c("striped", "scale_down"))
pprint <- comp_to_chance %>%
left_join(mean_var_age_tt, by=c("agehalf_day", "TrialType")) %>%
left_join(indiv_to_chance, by=c("agehalf_day", "TrialType")) %>%
mutate(val.print = paste(round(m,3), "(", round(std,3), ")", sep='')) %>%
mutate(c.print = paste(as.character(t), "/", tot, sep='')) %>%
mutate(bin.test = round(binom.test(t,tot)$p.value,3)) %>%
ungroup() %>%
mutate(TrialType = ifelse(TrialType=="Unique", "Specific", "Generic")) %>%
mutate("M(SD)"=val.print,
"comp. to chance"=t.test.text,
"t-test p-val"=t.test.pval.print,
"# subjs > chance"=c.print,
"binomial test p-val"=bin.test,
"Age Group"=agehalf_day,
"Trial Type"=TrialType)
kable(pprint %>% select("Age Group", "Trial Type", "M(SD)", "comp. to chance", "t-test p-val", "# subjs > chance", "binomial test p-val")) %>% kable_styling(latex_options = c("striped", "scale_down"))
